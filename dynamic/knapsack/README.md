# Задача об укладке рюкзака

- **N** - количество предметов
- **o** - предмет
  - **s** - размер
  - **w** - стоимость
- **K** - вместимость рюкзака
- **A** - набор предметов, решающий задачу
- **W** - общая стоимость этих предметов

Нужно добиться максимальной суммарной стоимости содержимого рюкзака.

## Решение

Наблюдение:

1. Если ```o[N] ∈ A```, то набор ```A \ { o[N] }``` решает задачу
   - с ```N - 1``` первыми предметами,
   - причем размер рюкзака равен ```K - s[N]```,
   - а стоимость ```W - w[N]```
2. Если ```o[N] ∉ A```, то набор ```A``` решает задачу
   - вместимостью ```K```,
   - если заданы только первые ```N - 1``` предметы

Формула:

```worth(N, K)``` =

- если ```s[N] <= K```, то ```max( worth(N - 1, K), w[N] + worth(N - 1, K - s[N]) )```
- если ```s[N] >  K```, то      ```worth(N - 1, K)```

## Пример 1

```text
N = 10, K = 8

#    1  2  3  4  5  6  7  8  9  N
o    o, o, o, o, o, o, o, o, o, o
s    1  1  1  1  1  1  1  1  1  2
w    2  1  2  2  1  2  2  2  1  3
A    ∈     ∈  ∈     ∈  ∈  ∈     ∈

W = 15

----------------------
| o[1] | o[3] | o[4] |
| o[6] | o[7] | o[8] |
-------| o[N] |-------
       --------

o[N] ∈ A

Если убрать последний предмет o[N]

----------------------
| o[1] | o[3] | o[4] |
| o[6] | o[7] | o[8] |
----------------------

то оставшийся набор предметов будет решением для задачи

N = N - 1 = 10 - 1 = 9

K = K - s[N] = 8 - 2 = 6

#    1  2  3  4  5  6  7  8  N
o    o, o, o, o, o, o, o, o, o
s    1  1  1  1  1  1  1  1  1
w    2  1  2  2  1  2  2  2  1
A    ∈     ∈  ∈     ∈  ∈  ∈   

W = W - w[N] = 15 - 3 = 12

Почему?

Если мы удаляем из целого решения часть, то оставшаяся часть будет являться
решением какой задачи?

Оставшаяся часть решения суммой размеров s своего набора предметов A задает
вместимость рюкзака K для нового условия задачи.

Удалив элемент из решения мы больше его не рассматриваем в целях решения
и следовательно его необходимо также удалить и из входных данных условия задачи.
Поэтому в новом условии количество предметов N будет на единицу меньше.

В рюкзаке находится ТОП предметов из всех доступных для выбора.
Каждый предмет из A в рюкзаке занял свое место.
Удаляя часть решения, удаляется предмет вместе со своим местом, но все
остальное остается не тронутым.
Места для размещения новых предметов не создано.
А текущие все и так на своих местах.
ТОП как был ТОПом так и остается.

Можно смотреть на рюкзак как на пазл.
А на предметы как фрагменты различной формы.
Если мозаика уже собрана и мы убираем фрагмент вместе с его местом,
то оставшуюся часть не нужно пересобирать.

o[N] ∉ A

Если входной предмет не попадает в выходное решение,
то имеющееся решение будет также решением для исходной задачи, но без
этого предмета.
Т.е. основой/ядром задачи являются только предметы попавшие в решение,
остальные можно не рассматривать. Они вне доски / за бортом.
```

## Пример 2

Если в футбольном резерве 111 человек и вам нужно набрать в команду 11.
То вы отбираете 11 лучших. Остальные отфильтровываются.
Если игрок из команды уходит из футбола и правила игры меняются так чтобы
в команде было только 10 человек, то десятка уже набранных сохранит свои места.
Потому что это 10 лучших.

## Выводы

Вся суть решения в том, что выбирается ТОП.
